<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–π –º–∞–≥–∞–∑–∏–Ω</title>
    <style>
        /* ... (–≤—Å–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ, –∫–∞–∫ –≤ –≤–∞—à–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ) ... */
    </style>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="app">
        <!-- –ë–µ–≥—É—â–∞—è —Å—Ç—Ä–æ–∫–∞ -->
        <div class="marquee">
            <div class="marquee-content">
                <span>üî• –ê–∫—Ü–∏—è! ‚Ä¢ –°–∫–∏–¥–∫–∞ 10% –Ω–∞ –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑ ‚Ä¢ –ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ ‚Ä¢ </span>
                <span>üî• –ê–∫—Ü–∏—è! ‚Ä¢ –°–∫–∏–¥–∫–∞ 10% –Ω–∞ –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑ ‚Ä¢ –ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ ‚Ä¢ </span>
                <span>üî• –ê–∫—Ü–∏—è! ‚Ä¢ –°–∫–∏–¥–∫–∞ 10% –Ω–∞ –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑ ‚Ä¢ –ë—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ ‚Ä¢ </span>
            </div>
        </div>

        <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ -->
        <div class="categories-wrapper">
            <button class="scroll-btn scroll-left" id="scrollLeft">‚Äπ</button>
            <div id="categories" class="categories">
                <div class="category active">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</div>
                <div class="category">–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞</div>
                <div class="category">–û–¥–µ–∂–¥–∞</div>
                <div class="category">–ö–Ω–∏–≥–∏</div>
                <div class="category">–î–ª—è –¥–æ–º–∞</div>
                <div class="category">–°–ø–æ—Ä—Ç</div>
                <div class="category">–ö—Ä–∞—Å–æ—Ç–∞</div>
                <div class="category">–ò–≥—Ä—É—à–∫–∏</div>
                <div class="category">–ê–≤—Ç–æ—Ç–æ–≤–∞—Ä—ã</div>
                <div class="category">–•–æ–±–±–∏</div>
            </div>
            <button class="scroll-btn scroll-right" id="scrollRight">‚Ä∫</button>
        </div>

        <!-- –ö–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="content">
            <!-- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ç–æ–≤–∞—Ä–∞–º–∏ -->
            <div id="main-page" class="page active">
                <div id="products" class="products-grid">
                    <!-- –¢–æ–≤–∞—Ä—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–æ—Ä–∑–∏–Ω—ã -->
            <div id="cart-page" class="page">
                <div class="page-header">
                    <h2>üõí –ö–æ—Ä–∑–∏–Ω–∞</h2>
                    <p id="cart-empty" class="empty-message" style="display: none;">–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–≤–∞—Ä—ã –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞</p>
                </div>
                <div id="cart-items" class="cart-items">
                    <!-- –¢–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω–µ -->
                </div>
                <div class="cart-footer hidden">
                    <div class="cart-total">
                        <span>–ò—Ç–æ–≥–æ:</span>
                        <span id="total-price">0 ‚ÇΩ</span>
                    </div>
                    <div class="checkout-buttons">
                        <button id="checkout-btn" class="checkout-btn">‚úÖ –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
                        <button id="clear-cart" class="clear-btn">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
                    </div>
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ -->
            <div id="checkout-page" class="page">
                <div class="page-header">
                    <h2>üöö –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞</h2>
                </div>
                <div class="checkout-form" style="padding: 20px;">
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">–ê–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ *</label>
                        <input type="text" id="address-input" placeholder="–ì–æ—Ä–æ–¥, —É–ª–∏—Ü–∞, –¥–æ–º, –∫–≤–∞—Ä—Ç–∏—Ä–∞" 
                               style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px;">
                        <small style="color: #666; font-size: 12px;">–ü—Ä–∏–º–µ—Ä: –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞, –¥. 10, –∫–≤. 25</small>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">–¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏ *</label>
                        <input type="tel" id="phone-input" placeholder="+7 (999) 123-45-67" 
                               style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px;">
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label style="display: block; margin-bottom: 8px; font-weight: 600;">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫ –∑–∞–∫–∞–∑—É</label>
                        <textarea id="comment-input" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è, –≤—Ä–µ–º—è –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ —Ç.–¥." 
                                  rows="3" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 16px; resize: vertical;"></textarea>
                    </div>
                    
                    <div id="order-summary" style="background: #f9f9f9; padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <h4 style="margin-top: 0;">üì¶ –í–∞—à –∑–∞–∫–∞–∑:</h4>
                        <div id="summary-items"></div>
                        <div style="display: flex; justify-content: space-between; font-weight: bold; margin-top: 10px;">
                            <span>–ò—Ç–æ–≥–æ:</span>
                            <span id="summary-total">0 ‚ÇΩ</span>
                        </div>
                    </div>
                    
                    <button id="confirm-checkout-btn" style="width: 100%; padding: 16px; background: #4CAF50; color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: 600; cursor: pointer;">üì¶ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑</button>
                    <button id="back-to-cart" style="width: 100%; padding: 12px; background: #f5f5f5; color: #666; border: none; border-radius: 10px; font-size: 16px; margin-top: 10px; cursor: pointer;">‚Ü©Ô∏è –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤ -->
            <div id="history-page" class="page">
                <div class="page-header">
                    <h2>üìã –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h2>
                    <p style="font-size: 14px; color: #666; margin-top: 5px;">–ó–¥–µ—Å—å –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤–∞—à–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</p>
                </div>
                <div id="orders-list" class="orders-list" style="padding: 15px;">
                    <!-- –ó–∞–∫–∞–∑—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </div>
                <div style="padding: 20px; text-align: center;">
                    <button id="refresh-orders" style="padding: 10px 20px; background: #2196F3; color: white; border: none; border-radius: 8px; cursor: pointer;">üîÑ –û–±–Ω–æ–≤–∏—Ç—å</button>
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è -->
            <div id="profile-page" class="page">
                <div class="page-header">
                    <h2>üë§ –ü—Ä–æ—Ñ–∏–ª—å</h2>
                </div>
                <div class="profile-info">
                    <div class="profile-card">
                        <div class="profile-name" id="profile-name">–ì–æ—Å—Ç—å</div>
                        <div style="margin-top: 10px; font-size: 14px;">ID: <span id="profile-id">-</span></div>
                    </div>
                    
                    <div class="profile-section">
                        <h3>üì¶ –ú–æ–∏ –∑–∞–∫–∞–∑—ã</h3>
                        <p style="margin-bottom: 15px;">–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –∏—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–æ–≤ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å—ã</p>
                        <button id="view-history" style="width: 100%; padding: 12px; background: #2196F3; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 600;">üìã –ü–µ—Ä–µ–π—Ç–∏ –∫ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤</button>
                    </div>
                    
                    <div class="profile-section">
                        <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                        <div class="settings-item">
                            <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                            <label class="switch">
                                <input type="checkbox" checked id="notifications-toggle">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="settings-item">
                            <span>–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
                            <label class="switch">
                                <input type="checkbox" id="theme-toggle">
                                <span class="slider"></span>
                            </label>
                        </div>
                        <div class="settings-item">
                            <span>–Ø–∑—ã–∫</span>
                            <span>–†—É—Å—Å–∫–∏–π</span>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <button class="support-btn" id="support-btn" style="width: 100%; padding: 15px; background: #f5f5f5; color: #666; border: none; border-radius: 10px; font-size: 16px; margin-bottom: 10px; cursor: not-allowed; opacity: 0.7;">üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ (—Å–∫–æ—Ä–æ)</button>
                        <button class="logout-btn" style="width: 100%; padding: 15px; background: #f5f5f5; color: #666; border: none; border-radius: 10px; font-size: 16px; cursor: pointer;">üö™ –í—ã–π—Ç–∏</button>
                    </div>
                </div>
            </div>

            <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ "–û –º–∞–≥–∞–∑–∏–Ω–µ" -->
            <div id="about-page" class="page">
                <div class="page-header">
                    <h2>‚ÑπÔ∏è –û –º–∞–≥–∞–∑–∏–Ω–µ</h2>
                </div>
                <div class="about-content">
                    <div class="about-card">
                        <h3>üõçÔ∏è –ú–æ–π –º–∞–≥–∞–∑–∏–Ω</h3>
                        <p>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω —Ç–æ–≤–∞—Ä–æ–≤ –Ω–∞ –ª—é–±–æ–π –≤–∫—É—Å.</p>
                        <p>–®–∏—Ä–æ–∫–∏–π –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç, –±—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –∏ –ø—Ä–∏—è—Ç–Ω—ã–µ —Ü–µ–Ω—ã.</p>
                    </div>
                    
                    <div class="about-section">
                        <h3>üì¶ –ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –∑–∞–∫–∞–∑</h3>
                        <div class="step">
                            <div class="step-number">1</div>
                            <div class="step-text">–í—ã–±–∏—Ä–∞–µ—Ç–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–∞—Ç–∞–ª–æ–≥–µ</div>
                        </div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-text">–î–æ–±–∞–≤–ª—è–µ—Ç–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É</div>
                        </div>
                        <div class="step">
                            <div class="step-number">3</div>
                            <div class="step-text">–£–∫–∞–∑—ã–≤–∞–µ—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏ –∏ —Ç–µ–ª–µ—Ñ–æ–Ω</div>
                        </div>
                        <div class="step">
                            <div class="step-number">4</div>
                            <div class="step-text">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ –∑–∞–∫–∞–∑ –≤ Telegram –±–æ—Ç–µ</div>
                        </div>
                    </div>
                    
                    <div class="about-section">
                        <h3>üìä –°—Ç–∞—Ç—É—Å—ã –∑–∞–∫–∞–∑–æ–≤</h3>
                        <div style="margin-bottom: 10px;">
                            <span style="display: inline-block; width: 20px; text-align: center;">üÜï</span>
                            <span><strong>–ù–æ–≤—ã–π</strong> - –∑–∞–∫–∞–∑ –ø—Ä–∏–Ω—è—Ç, –æ–∂–∏–¥–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏</span>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span style="display: inline-block; width: 20px; text-align: center;">‚öôÔ∏è</span>
                            <span><strong>–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</strong> - –∑–∞–∫–∞–∑ –≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ</span>
                        </div>
                        <div style="margin-bottom: 10px;">
                            <span style="display: inline-block; width: 20px; text-align: center;">‚úÖ</span>
                            <span><strong>–í—ã–ø–æ–ª–Ω–µ–Ω</strong> - –∑–∞–∫–∞–∑ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω –∏ –∑–∞–≤–µ—Ä—à–µ–Ω</span>
                        </div>
                        <div>
                            <span style="display: inline-block; width: 20px; text-align: center;">‚ùå</span>
                            <span><strong>–û—Ç–º–µ–Ω–µ–Ω</strong> - –∑–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω</span>
                        </div>
                    </div>
                    
                    <div class="about-section">
                        <h3>üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                        <p>–ü–æ–¥–¥–µ—Ä–∂–∫–∞: @konsik_support</p>
                        <p>–î–æ—Å—Ç–∞–≤–∫–∞: –ø–æ –≤—Å–µ–º—É –≥–æ—Ä–æ–¥—É</p>
                        <p>–í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: 9:00-21:00</p>
                    </div>
                    
                    <div class="about-section">
                        <h3>üöö –î–æ—Å—Ç–∞–≤–∫–∞ –∏ –æ–ø–ª–∞—Ç–∞</h3>
                        <p>‚Ä¢ –ö—É—Ä—å–µ—Ä—Å–∫–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ 1-2 –¥–Ω—è</p>
                        <p>‚Ä¢ –°–∞–º–æ–≤—ã–≤–æ–∑ –∏–∑ –ø—É–Ω–∫—Ç–æ–≤ –≤—ã–¥–∞—á–∏</p>
                        <p>‚Ä¢ –û–ø–ª–∞—Ç–∞ –∫–∞—Ä—Ç–æ–π –∏–ª–∏ –Ω–∞–ª–∏—á–Ω—ã–º–∏ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é -->
        <div class="bottom-menu">
            <div class="menu-item active" data-page="main">
                <span>üè†</span>
                <span>–ö–∞—Ç–∞–ª–æ–≥</span>
            </div>
            <div class="menu-item" data-page="cart">
                <span>üõí</span>
                <span>–ö–æ—Ä–∑–∏–Ω–∞</span>
                <span class="cart-badge hidden">0</span>
            </div>
            <div class="menu-item" data-page="history">
                <span>üìã</span>
                <span>–ò—Å—Ç–æ—Ä–∏—è</span>
            </div>
            <div class="menu-item" data-page="profile">
                <span>üë§</span>
                <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
            </div>
            <div class="menu-item" data-page="about">
                <span>‚ÑπÔ∏è</span>
                <span>–û –Ω–∞—Å</span>
            </div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.setHeaderColor('#2196F3');
        tg.enableClosingConfirmation();

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let state = {
            cart: [],
            balance: 500,
            currentPage: 'main',
            selectedCategory: '–í—Å–µ —Ç–æ–≤–∞—Ä—ã',
            theme: 'light',
            notifications: true,
            userId: null,
            orders: []
        };

        // –î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–æ–≤
        const products = [
            { id: 1, name: "üì± –°–º–∞—Ä—Ç—Ñ–æ–Ω Xiaomi", price: 19900, category: "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", desc: "–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–º–∞—Ä—Ç—Ñ–æ–Ω —Å —Ö–æ—Ä–æ—à–µ–π –∫–∞–º–µ—Ä–æ–π" },
            { id: 2, name: "üéß –ë–µ—Å–ø—Ä–æ–≤–æ–¥–Ω—ã–µ –Ω–∞—É—à–Ω–∏–∫–∏", price: 3200, category: "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", desc: "–ù–∞—É—à–Ω–∏–∫–∏ —Å —à—É–º–æ–ø–æ–¥–∞–≤–ª–µ–Ω–∏–µ–º" },
            { id: 3, name: "üëï –§—É—Ç–±–æ–ª–∫–∞ –º—É–∂—Å–∫–∞—è", price: 1500, category: "–û–¥–µ–∂–¥–∞", desc: "–•–ª–æ–ø–∫–æ–≤–∞—è —Ñ—É—Ç–±–æ–ª–∫–∞, —Ä–∞–∑–º–µ—Ä—ã S-XXL" },
            { id: 4, name: "üìö –ö–Ω–∏–≥–∞ '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ'", price: 1200, category: "–ö–Ω–∏–≥–∏", desc: "–£—á–µ–±–Ω–∏–∫ –ø–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—é –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö" },
            { id: 5, name: "üèÄ –ë–∞—Å–∫–µ—Ç–±–æ–ª—å–Ω—ã–π –º—è—á", price: 2500, category: "–°–ø–æ—Ä—Ç", desc: "–ú—è—á –¥–ª—è –∏–≥—Ä—ã –≤ –±–∞—Å–∫–µ—Ç–±–æ–ª" },
            { id: 6, name: "üíÑ –ù–∞–±–æ—Ä –∫–æ—Å–º–µ—Ç–∏–∫–∏", price: 2800, category: "–ö—Ä–∞—Å–æ—Ç–∞", desc: "–ù–∞–±–æ—Ä –¥–ª—è –º–∞–∫–∏—è–∂–∞, 10 –ø—Ä–µ–¥–º–µ—Ç–æ–≤" },
            { id: 7, name: "üß∏ –ü–ª—é—à–µ–≤—ã–π –º–µ–¥–≤–µ–¥—å", price: 1800, category: "–ò–≥—Ä—É—à–∫–∏", desc: "–ë–æ–ª—å—à–æ–π –º—è–≥–∫–∏–π –º–µ–¥–≤–µ–¥—å 50—Å–º" },
            { id: 8, name: "üöó –ß–µ—Ö–æ–ª –¥–ª—è –∞–≤—Ç–æ", price: 3200, category: "–ê–≤—Ç–æ—Ç–æ–≤–∞—Ä—ã", desc: "–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —á–µ—Ö–æ–ª –Ω–∞ —Å–∏–¥–µ–Ω—å–µ" },
            { id: 9, name: "üé® –ù–∞–±–æ—Ä –¥–ª—è —Ä–∏—Å–æ–≤–∞–Ω–∏—è", price: 1900, category: "–•–æ–±–±–∏", desc: "24 —Ü–≤–µ—Ç–∞, –∫–∏—Å—Ç–∏ –∏ –±—É–º–∞–≥–∞" },
            { id: 10, name: "‚òï –ö–æ—Ñ–µ–º–∞—à–∏–Ω–∞", price: 8900, category: "–î–ª—è –¥–æ–º–∞", desc: "–ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –∫–æ—Ñ–µ–º–∞—à–∏–Ω–∞ –¥–ª—è –¥–æ–º–∞" },
            { id: 11, name: "‚åö –£–º–Ω—ã–µ —á–∞—Å—ã", price: 4500, category: "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞", desc: "–§–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–∫–µ—Ä —Å —Å–µ–Ω—Å–æ—Ä–Ω—ã–º —ç–∫—Ä–∞–Ω–æ–º" },
            { id: 12, name: "üëó –ü–ª–∞—Ç—å–µ –≤–µ—á–µ—Ä–Ω–µ–µ", price: 5500, category: "–û–¥–µ–∂–¥–∞", desc: "–≠–ª–µ–≥–∞–Ω—Ç–Ω–æ–µ –ø–ª–∞—Ç—å–µ –¥–ª—è –≤–µ—á–µ—Ä–∞" }
        ];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            initApp();
            setupEventListeners();
            setupCategoryScrolling();
            setupCartScrolling();
            showPage('main');
            renderProducts();
            updateCartBadge();
            loadUserProfile();
        });

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        function initApp() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–∑ localStorage –µ—Å–ª–∏ –µ—Å—Ç—å
            const savedState = localStorage.getItem('shopState');
            if (savedState) {
                const parsed = JSON.parse(savedState);
                state.cart = parsed.cart || [];
                state.balance = parsed.balance || 500;
                state.selectedCategory = parsed.selectedCategory || '–í—Å–µ —Ç–æ–≤–∞—Ä—ã';
                state.theme = parsed.theme || 'light';
                state.notifications = parsed.notifications !== undefined ? parsed.notifications : true;
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É
            if (state.theme === 'dark') {
                document.body.classList.add('dark-theme');
                document.getElementById('theme-toggle').checked = true;
                tg.setBackgroundColor('#121212');
            } else {
                tg.setBackgroundColor('#f8f8f8');
            }
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            document.getElementById('notifications-toggle').checked = state.notifications;
            
            // –ü–æ–ª—É—á–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
            if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                state.userId = tg.initDataUnsafe.user.id;
                document.getElementById('profile-id').textContent = state.userId;
            }
            
            console.log('–ú–∞–≥–∞–∑–∏–Ω —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω');
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
        function saveState() {
            localStorage.setItem('shopState', JSON.stringify({
                cart: state.cart,
                balance: state.balance,
                selectedCategory: state.selectedCategory,
                theme: state.theme,
                notifications: state.notifications
            }));
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
        function loadUserProfile() {
            try {
                const user = tg.initDataUnsafe.user;
                if (user) {
                    const firstName = user.first_name || '';
                    const lastName = user.last_name || '';
                    const fullName = [firstName, lastName].filter(Boolean).join(' ');
                    
                    document.getElementById('profile-name').textContent = fullName || '–ì–æ—Å—Ç—å';
                    state.userId = user.id;
                    document.getElementById('profile-id').textContent = user.id;
                    
                    console.log('–ü—Ä–æ—Ñ–∏–ª—å Telegram –∑–∞–≥—Ä—É–∂–µ–Ω:', user);
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    loadUserOrders();
                } else {
                    console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–æ—Å—Ç–µ–≤–∞—è —É—á–µ—Ç–∫–∞');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è:', error);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        async function loadUserOrders() {
            if (!state.userId) return;
            
            try {
                const response = await fetch(`http://localhost:8080/api/user_orders?user_id=${state.userId}`);
                if (response.ok) {
                    const data = await response.json();
                    state.orders = data.orders || [];
                    console.log('–ó–∞–≥—Ä—É–∂–µ–Ω—ã –∑–∞–∫–∞–∑—ã:', state.orders.length);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤:', error);
            }
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
        function setupCategoryScrolling() {
            const categories = document.querySelector('.categories');
            const scrollLeft = document.getElementById('scrollLeft');
            const scrollRight = document.getElementById('scrollRight');
            
            if (!categories || !scrollLeft || !scrollRight) return;
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–ª–µ–≤–æ
            scrollLeft.addEventListener('click', () => {
                categories.scrollBy({
                    left: -150,
                    behavior: 'smooth'
                });
            });
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–ø—Ä–∞–≤–æ
            scrollRight.addEventListener('click', () => {
                categories.scrollBy({
                    left: 150,
                    behavior: 'smooth'
                });
            });
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫–∏ –µ—Å–ª–∏ –Ω–µ—á–µ–≥–æ —Å–∫—Ä–æ–ª–ª–∏—Ç—å
            const updateScrollButtons = () => {
                const scrollLeftVisible = categories.scrollLeft > 0;
                const scrollRightVisible = 
                    categories.scrollLeft < categories.scrollWidth - categories.clientWidth - 1;
                
                scrollLeft.style.opacity = scrollLeftVisible ? '1' : '0.3';
                scrollLeft.style.cursor = scrollLeftVisible ? 'pointer' : 'default';
                
                scrollRight.style.opacity = scrollRightVisible ? '1' : '0.3';
                scrollRight.style.cursor = scrollRightVisible ? 'pointer' : 'default';
            };
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ
            categories.addEventListener('scroll', updateScrollButtons);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            setTimeout(updateScrollButtons, 100);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–∏ —Ä–µ—Å–∞–π–∑–µ
            window.addEventListener('resize', updateScrollButtons);
        }

        // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã
        function setupCartScrolling() {
            const cartItems = document.getElementById('cart-items');
            if (!cartItems) return;
            
            let isScrolling = false;
            let startX;
            let scrollLeft;
            
            cartItems.addEventListener('mousedown', (e) => {
                isScrolling = true;
                startX = e.pageX - cartItems.offsetLeft;
                scrollLeft = cartItems.scrollLeft;
            });
            
            cartItems.addEventListener('mouseleave', () => {
                isScrolling = false;
            });
            
            cartItems.addEventListener('mouseup', () => {
                isScrolling = false;
            });
            
            cartItems.addEventListener('mousemove', (e) => {
                if (!isScrolling) return;
                e.preventDefault();
                const x = e.pageX - cartItems.offsetLeft;
                const walk = (x - startX) * 2;
                cartItems.scrollLeft = scrollLeft - walk;
            });
            
            // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
            cartItems.addEventListener('touchstart', (e) => {
                isScrolling = true;
                startX = e.touches[0].pageX - cartItems.offsetLeft;
                scrollLeft = cartItems.scrollLeft;
            });
            
            cartItems.addEventListener('touchend', () => {
                isScrolling = false;
            });
            
            cartItems.addEventListener('touchmove', (e) => {
                if (!isScrolling) return;
                e.preventDefault();
                const x = e.touches[0].pageX - cartItems.offsetLeft;
                const walk = (x - startX) * 2;
                cartItems.scrollLeft = scrollLeft - walk;
            });
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤
            document.querySelectorAll('.category').forEach(cat => {
                cat.addEventListener('click', (e) => {
                    const categoryName = cat.textContent;
                    selectCategory(categoryName);
                    
                    cat.scrollIntoView({
                        behavior: 'smooth',
                        inline: 'center',
                        block: 'nearest'
                    });
                });
            });

            // –ù–∏–∂–Ω–µ–µ –º–µ–Ω—é
            document.querySelectorAll('.menu-item').forEach(item => {
                item.addEventListener('click', (e) => {
                    const page = item.dataset.page;
                    showPage(page);
                    
                    document.querySelectorAll('.menu-item').forEach(i => {
                        i.classList.remove('active');
                    });
                    item.classList.add('active');
                });
            });

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É
            document.addEventListener('click', (e) => {
                if (e.target.classList.contains('add-to-cart')) {
                    const productId = parseInt(e.target.dataset.id);
                    addToCart(productId);
                }
                
                if (e.target.classList.contains('quick-buy-btn')) {
                    const productId = parseInt(e.target.dataset.id);
                    const product = products.find(p => p.id === productId);
                    
                    if (product) {
                        // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ—Ä–∑–∏–Ω—É –∏ –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é
                        addToCart(productId);
                        showPage('cart');
                    }
                }
                
                if (e.target.classList.contains('cart-item-remove')) {
                    const productId = parseInt(e.target.dataset.id);
                    removeFromCart(productId);
                }
            });

            // –ö–Ω–æ–ø–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã
            document.getElementById('checkout-btn')?.addEventListener('click', () => {
                goToCheckout();
            });
            
            document.getElementById('clear-cart')?.addEventListener('click', () => {
                clearCart();
            });
            
            // –ö–Ω–æ–ø–∫–∞ –Ω–∞–∑–∞–¥ –≤ –∫–æ—Ä–∑–∏–Ω—É
            document.getElementById('back-to-cart')?.addEventListener('click', () => {
                showPage('cart');
            });
            
            // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
            document.getElementById('confirm-checkout-btn')?.addEventListener('click', () => {
                confirmCheckout();
            });
            
            // –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤
            document.getElementById('view-history')?.addEventListener('click', () => {
                showPage('history');
            });
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤
            document.getElementById('refresh-orders')?.addEventListener('click', () => {
                loadUserOrders();
                renderOrderHistory();
            });
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
            const themeToggle = document.getElementById('theme-toggle');
            if (themeToggle) {
                themeToggle.addEventListener('change', (e) => {
                    const isDark = e.target.checked;
                    toggleTheme(isDark);
                });
            }
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            const notificationsToggle = document.getElementById('notifications-toggle');
            if (notificationsToggle) {
                notificationsToggle.addEventListener('change', (e) => {
                    state.notifications = e.target.checked;
                    saveState();
                    showNotification(`–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ${state.notifications ? '–≤–∫–ª—é—á–µ–Ω—ã' : '–≤—ã–∫–ª—é—á–µ–Ω—ã'}`);
                });
            }
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
        function toggleTheme(isDark) {
            if (isDark) {
                document.body.classList.add('dark-theme');
                state.theme = 'dark';
                tg.setBackgroundColor('#121212');
            } else {
                document.body.classList.remove('dark-theme');
                state.theme = 'light';
                tg.setBackgroundColor('#f8f8f8');
            }
            saveState();
        }

        // –í—ã–±–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
        function selectCategory(categoryName) {
            document.querySelectorAll('.category').forEach(c => {
                c.classList.remove('active');
            });
            
            const categories = Array.from(document.querySelectorAll('.category'));
            const selectedCat = categories.find(cat => cat.textContent === categoryName);
            if (selectedCat) {
                selectedCat.classList.add('active');
                state.selectedCategory = categoryName;
                renderProducts(categoryName);
                saveState();
            }
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
        function showPage(pageName) {
            console.log('–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É:', pageName);
            
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            const pageElement = document.getElementById(`${pageName}-page`);
            if (pageElement) {
                pageElement.classList.add('active');
            }
            
            const categoriesElement = document.querySelector('.categories-wrapper');
            const marqueeElement = document.querySelector('.marquee');
            
            if (pageName === 'main') {
                categoriesElement.style.display = 'flex';
                marqueeElement.style.display = 'block';
            } else {
                categoriesElement.style.display = 'none';
                marqueeElement.style.display = 'none';
            }
            
            state.currentPage = pageName;
            
            switch(pageName) {
                case 'cart':
                    renderCart();
                    break;
                case 'checkout':
                    renderCheckoutSummary();
                    break;
                case 'history':
                    renderOrderHistory();
                    break;
                case 'main':
                    renderProducts(state.selectedCategory);
                    break;
            }
            
            saveState();
        }

        // –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—é –∑–∞–∫–∞–∑–∞
        function goToCheckout() {
            if (state.cart.length === 0) {
                showNotification('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞');
                return;
            }
            showPage('checkout');
        }

        // –†–µ–Ω–¥–µ—Ä —Ç–æ–≤–∞—Ä–æ–≤
        function renderProducts(category = '–í—Å–µ —Ç–æ–≤–∞—Ä—ã') {
            const container = document.getElementById('products');
            if (!container) return;
            
            container.innerHTML = '';
            
            const filteredProducts = category === '–í—Å–µ —Ç–æ–≤–∞—Ä—ã' 
                ? products 
                : products.filter(p => p.category === category);
            
            if (filteredProducts.length === 0) {
                container.innerHTML = '<div class="empty-message">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }
            
            filteredProducts.forEach(product => {
                const inCart = state.cart.find(item => item.id === product.id);
                const quantity = inCart ? inCart.quantity : 0;
                
                const productElement = document.createElement('div');
                productElement.className = 'product-card';
                productElement.innerHTML = `
                    <div class="product-image"></div>
                    <div class="product-info">
                        <div class="product-title">${product.name}</div>
                        <div class="product-desc">${product.desc}</div>
                        <div class="product-price">${product.price.toLocaleString()} ‚ÇΩ</div>
                        <button class="add-to-cart" data-id="${product.id}">
                            ${quantity > 0 ? `‚úì –í –∫–æ—Ä–∑–∏–Ω–µ (${quantity})` : 'üõí –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É'}
                        </button>
                        <button class="quick-buy-btn" data-id="${product.id}">
                            ‚ö° –ë—ã—Å—Ç—Ä—ã–π –∑–∞–∫–∞–∑
                        </button>
                    </div>
                `;
                container.appendChild(productElement);
            });
        }

        // –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;
            
            const existing = state.cart.find(item => item.id === productId);
            
            if (existing) {
                existing.quantity += 1;
            } else {
                state.cart.push({ 
                    ...product, 
                    quantity: 1,
                    addedAt: new Date().toISOString()
                });
            }
            
            updateCartBadge();
            saveState();
            
            if (state.currentPage === 'main') {
                renderProducts(state.selectedCategory);
            }
            
            if (state.currentPage === 'cart') {
                renderCart();
            }
            
            showNotification(`–î–æ–±–∞–≤–ª–µ–Ω–æ: ${product.name}`);
        }

        // –£–¥–∞–ª–∏—Ç—å –∏–∑ –∫–æ—Ä–∑–∏–Ω—ã
        function removeFromCart(productId) {
            state.cart = state.cart.filter(item => item.id !== productId);
            
            updateCartBadge();
            saveState();
            renderCart();
            
            if (state.currentPage === 'main') {
                renderProducts(state.selectedCategory);
            }
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –±–µ–π–¥–∂ –∫–æ—Ä–∑–∏–Ω—ã
        function updateCartBadge() {
            const badge = document.querySelector('.cart-badge');
            const totalItems = state.cart.reduce((sum, item) => sum + item.quantity, 0);
            
            if (badge) {
                if (totalItems > 0) {
                    badge.textContent = totalItems > 9 ? '9+' : totalItems;
                    badge.classList.remove('hidden');
                } else {
                    badge.classList.add('hidden');
                }
            }
        }

        // –†–µ–Ω–¥–µ—Ä –∫–æ—Ä–∑–∏–Ω—ã
        function renderCart() {
            const container = document.getElementById('cart-items');
            const totalPriceElement = document.getElementById('total-price');
            const emptyMessage = document.getElementById('cart-empty');
            const checkoutBtn = document.getElementById('checkout-btn');
            const clearBtn = document.getElementById('clear-cart');
            const cartFooter = document.querySelector('.cart-footer');
            
            if (!container) return;
            
            container.innerHTML = '';
            
            if (state.cart.length === 0) {
                if (state.currentPage === 'cart') {
                    emptyMessage.style.display = 'block';
                } else {
                    emptyMessage.style.display = 'none';
                }
                if (checkoutBtn) checkoutBtn.disabled = true;
                if (clearBtn) clearBtn.disabled = true;
                if (totalPriceElement) totalPriceElement.textContent = '0 ‚ÇΩ';
                
                if (cartFooter) cartFooter.classList.add('hidden');
                return;
            }
            
            emptyMessage.style.display = 'none';
            if (cartFooter) cartFooter.classList.remove('hidden');
            
            if (checkoutBtn) checkoutBtn.disabled = false;
            if (clearBtn) clearBtn.disabled = false;
            
            let total = 0;
            
            state.cart.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                const itemElement = document.createElement('div');
                itemElement.className = 'cart-item';
                itemElement.innerHTML = `
                    <div class="cart-item-info">
                        <div class="cart-item-title">${item.name}</div>
                        <div class="cart-item-desc">${item.desc}</div>
                        <div class="cart-item-price">${item.price.toLocaleString()} ‚ÇΩ √ó ${item.quantity}</div>
                    </div>
                    <div class="cart-item-controls">
                        <div class="cart-item-quantity">${itemTotal.toLocaleString()} ‚ÇΩ</div>
                        <button class="cart-item-remove" data-id="${item.id}" title="–£–¥–∞–ª–∏—Ç—å">√ó</button>
                    </div>
                `;
                container.appendChild(itemElement);
            });
            
            if (totalPriceElement) {
                totalPriceElement.textContent = `${total.toLocaleString()} ‚ÇΩ`;
            }
        }

        // –†–µ–Ω–¥–µ—Ä —Å–≤–æ–¥–∫–∏ –∑–∞–∫–∞–∑–∞ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è
        function renderCheckoutSummary() {
            const summaryItems = document.getElementById('summary-items');
            const summaryTotal = document.getElementById('summary-total');
            
            if (!summaryItems || !summaryTotal) return;
            
            let itemsHTML = '';
            let total = 0;
            
            state.cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                total += itemTotal;
                
                itemsHTML += `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 14px;">
                        <span>${item.name} √ó ${item.quantity}</span>
                        <span>${itemTotal.toLocaleString()} ‚ÇΩ</span>
                    </div>
                `;
            });
            
            summaryItems.innerHTML = itemsHTML;
            summaryTotal.textContent = `${total.toLocaleString()} ‚ÇΩ`;
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª—è —Ñ–æ—Ä–º—ã
            document.getElementById('address-input').value = '';
            document.getElementById('phone-input').value = '';
            document.getElementById('comment-input').value = '';
        }

        // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
        function confirmCheckout() {
            const address = document.getElementById('address-input').value.trim();
            const phone = document.getElementById('phone-input').value.trim();
            const comment = document.getElementById('comment-input').value.trim();
            
            if (!address) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –¥–æ—Å—Ç–∞–≤–∫–∏');
                return;
            }
            
            if (!phone) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–ª–µ—Ñ–æ–Ω –¥–ª—è —Å–≤—è–∑–∏');
                return;
            }
            
            if (state.cart.length === 0) {
                showNotification('–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞');
                return;
            }
            
            const total = state.cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            // –°–æ–∑–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞
            const orderData = {
                action: 'checkout',
                cart: state.cart.map(item => ({
                    id: item.id,
                    name: item.name,
                    price: item.price,
                    quantity: item.quantity,
                    description: item.desc
                })),
                total: total,
                address: address,
                phone: phone,
                comment: comment,
                shop: '–ú–æ–π –º–∞–≥–∞–∑–∏–Ω',
                timestamp: new Date().toISOString(),
                user_id: state.userId,
                user_name: tg.initDataUnsafe.user?.first_name || '–ü–æ–∫—É–ø–∞—Ç–µ–ª—å'
            };
            
            console.log('–û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–∫–∞–∑ –≤ –±–æ—Ç–∞:', orderData);
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Telegram –±–æ—Ç–∞
            if (tg && tg.sendData) {
                tg.sendData(JSON.stringify(orderData));
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                showNotification('‚úÖ –ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±–æ—Ç–∞ –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è.', 5000);
                
                // –û—á–∏—â–∞–µ–º –∫–æ—Ä–∑–∏–Ω—É
                state.cart = [];
                updateCartBadge();
                saveState();
                renderCart();
                
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é
                showPage('main');
            } else {
                showNotification('‚ùå –û—à–∏–±–∫–∞: –Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–∫–∞–∑');
            }
        }

        // –û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É
        function clearCart() {
            if (state.cart.length === 0 || !confirm('–û—á–∏—Å—Ç–∏—Ç—å –∫–æ—Ä–∑–∏–Ω—É?')) return;
            
            state.cart = [];
            updateCartBadge();
            saveState();
            renderCart();
            
            if (state.currentPage === 'main') {
                renderProducts(state.selectedCategory);
            }
            
            showNotification('–ö–æ—Ä–∑–∏–Ω–∞ –æ—á–∏—â–µ–Ω–∞');
        }

        // –†–µ–Ω–¥–µ—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤
        function renderOrderHistory() {
            const container = document.getElementById('orders-list');
            if (!container) return;
            
            if (!state.userId) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">üîí</div>
                        <h3 style="margin-bottom: 15px;">–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h3>
                        <p style="color: #666; margin-bottom: 20px;">–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram</p>
                    </div>
                `;
                return;
            }
            
            if (state.orders.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">üì≠</div>
                        <h3 style="margin-bottom: 15px;">–ó–∞–∫–∞–∑–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç</h3>
                        <p style="color: #666; margin-bottom: 20px;">–°–¥–µ–ª–∞–π—Ç–µ –ø–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑ –≤ –Ω–∞—à–µ–º –º–∞–≥–∞–∑–∏–Ω–µ!</p>
                        <button onclick="showPage('main')" style="padding: 10px 20px; background: #2196F3; color: white; border: none; border-radius: 8px; cursor: pointer;">üõçÔ∏è –ü–µ—Ä–µ–π—Ç–∏ –≤ –º–∞–≥–∞–∑–∏–Ω</button>
                    </div>
                `;
                return;
            }
            
            let html = '';
            
            state.orders.forEach(order => {
                const items = order.items || [];
                const date = new Date(order.created_at).toLocaleString('ru-RU', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                // –ò–∫–æ–Ω–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
                const statusIcons = {
                    'new': 'üÜï',
                    'processing': '‚öôÔ∏è',
                    'completed': '‚úÖ',
                    'cancelled': '‚ùå'
                };
                const statusIcon = statusIcons[order.status] || 'üì¶';
                
                // –¶–≤–µ—Ç —Å—Ç–∞—Ç—É—Å–∞
                const statusColors = {
                    'new': '#2196F3',
                    'processing': '#FF9800',
                    'completed': '#4CAF50',
                    'cancelled': '#f44336'
                };
                const statusColor = statusColors[order.status] || '#666';
                
                html += `
                    <div class="order-card" style="background: white; border-radius: 10px; padding: 15px; margin-bottom: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); border-left: 4px solid ${statusColor};">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                            <div style="font-weight: 600;">${statusIcon} –ó–∞–∫–∞–∑ #${order.order_id}</div>
                            <div style="color: #666;">${date}</div>
                        </div>
                        
                        <div style="margin-bottom: 10px;">
                            <div style="margin-bottom: 5px;">
                                <span style="font-weight: 600;">–°—Ç–∞—Ç—É—Å:</span>
                                <span style="color: ${statusColor}; font-weight: 600; margin-left: 5px;">${order.status}</span>
                            </div>
                            <div style="margin-bottom: 5px; font-size: 14px; color: #666;">
                                üìç ${order.address || '–ê–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω'}
                            </div>
                            <div style="font-size: 14px; color: #666;">
                                üì± ${order.phone || '–¢–µ–ª–µ—Ñ–æ–Ω –Ω–µ —É–∫–∞–∑–∞–Ω'}
                            </div>
                        </div>
                        
                        <div style="border-top: 1px solid #eee; padding-top: 10px;">
                            <div style="font-weight: 600; margin-bottom: 5px;">–¢–æ–≤–∞—Ä—ã (${items.length}):</div>
                            ${items.slice(0, 3).map(item => `
                                <div style="font-size: 14px; margin-bottom: 3px;">
                                    ‚Ä¢ ${item.name} - ${item.quantity} √ó ${item.price} ‚ÇΩ
                                </div>
                            `).join('')}
                            ${items.length > 3 ? `<div style="font-size: 14px; color: #666;">... –∏ –µ—â–µ ${items.length - 3} —Ç–æ–≤–∞—Ä–∞</div>` : ''}
                        </div>
                        
                        <div style="display: flex; justify-content: space-between; margin-top: 10px; padding-top: 10px; border-top: 1px solid #eee;">
                            <div style="font-weight: 600;">–ò—Ç–æ–≥–æ:</div>
                            <div style="font-weight: 600; color: #2196F3;">${order.total_amount?.toLocaleString() || '0'} ‚ÇΩ</div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, duration = 3000) {
            if (!state.notifications) return;
            
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
                background: ${state.theme === 'dark' ? '#64B5F6' : '#2196F3'};
                color: white;
                padding: 12px 24px;
                border-radius: 25px;
                box-shadow: 0 4px 15px rgba(33, 150, 243, 0.3);
                z-index: 10000;
                font-weight: 500;
                animation: slideIn 0.3s ease;
                text-align: center;
                max-width: 90%;
                word-break: break-word;
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            }, duration);
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { top: -50px; opacity: 0; }
                to { top: 20px; opacity: 1; }
            }
        `;
        document.head.appendChild(style);

        // –î–ª—è –æ—Ç–ª–∞–¥–∫–∏
        console.log('‚úÖ –ú–∞–≥–∞–∑–∏–Ω —Ç–æ–≤–∞—Ä–æ–≤ –∑–∞–≥—Ä—É–∂–µ–Ω');
        console.log('üîó Web App URL:', window.location.href);
        console.log('ü§ñ Telegram WebApp –¥–æ—Å—Ç—É–ø–µ–Ω:', !!tg);
        console.log('üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Telegram:', tg.initDataUnsafe?.user);
        console.log('üì¶ –¢–æ–≤–∞—Ä–æ–≤ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ:', products.length);
    </script>
</body>
</html>